# ConfBuster++

## Info
An RDKit implementation of ConfBuster's<sup>[1]</sup> algorithm for macrocycle conformer generation. This is a stand-alone version of the conformer generator used in [CPMG](https://github.com/e-dang/Composite-Peptide-Macrocycle-Generator.git). This tool has only been tested on macrocycles generated by [CPMG](https://github.com/e-dang/Composite-Peptide-Macrocycle-Generator.git) where the macrocycle ring has one alkene, does not contain any bridges, and are between 10 and 25 atoms large. However, in general, this tool should work for any other type of un-bridge macrocycle.

## Sample Results
These examples were all run using the following arguments (as was done in [CPMG](https://github.com/e-dang/Composite-Peptide-Macrocycle-Generator.git)):
```
-r 1 -m 3 -N 5 -n 15 -e 5
```

#### Macrocycle_0
| Number of Rotatable Bonds | Number of Cleavable Bonds | Macro-Ring Size |
| :-----------------------: | :-----------------------: | :-------------: |
|             5             |            10             |       23        |

<div style="text-align:center">
<img src="examples/images/macrocycle_0.png" width="300"/>
<img src="examples/images/macrocycle_0_pymol.png" width="300"/>
</div>

#### Macrocycle_1
| Number of Rotatable Bonds | Number of Cleavable Bonds | Macro-Ring Size |
| :-----------------------: | :-----------------------: | :-------------: |
|             8             |             6             |       19        |

<div style="text-align:center">
<img src="examples/images/macrocycle_1.png" width="300"/>
<img src="examples/images/macrocycle_1_pymol.png" width="300"/>
</div>

## Dependencies
- Python3.6.8
- [RDKit](http://rdkit.org)<sup>[2]</sup>
- [OpenBabel](http://openbabel.org/wiki/Main_Page)<sup>[3]</sup>

For molecular visualization:
- [Pymol](https://pymol.org/2/)

Optionally, in order to run the __stats.py__ script for generating the graphs above you will need:
- [NumPy](https://numpy.org/) 1.18.1
- [Matplotlib](https://matplotlib.org/) 3.1.1
- [Pandas](https://pandas.pydata.org/) 0.24.2
- [Seaborn](https://seaborn.pydata.org/) 0.9.0

## Usage
```
python -m path/to/confbusterplusplus --smiles <SMILES string> -o path/to/output_file.pdb
```

There are also a number of different parameters that may be specified to modify how the conformational sampling process is performed. A full list of options can be seen by typing the command:
```
python -m path/to/confbusterplusplus --help
```

As an example, this is how you would run the conformational sampling process with an energy cutoff of 5 kcal/mol:
```
python -m path/to/confbusterplusplus --smiles <SMILES string> -e 5 -o path/to/output_file.pdb
```

## Citations
- [1] Barbeau, Xavier, et al. “ConfBuster: Open-Source Tools for Macrocycle Conformational Search and Analysis.” Journal
of Open Research Software, vol. 6, 2018, doi:10.5334/jors.189.
- [2] Landrum G. RDKit: Open-source cheminformatics.
- [3] Oboyle, Noel M, et al. “Open Babel: An Open Chemical Toolbox.” Journal of Cheminformatics, vol. 3, no. 1, July 2011, doi:10.1186/1758-2946-3-33.